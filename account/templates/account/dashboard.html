{% load static %}
<!DOCTYPE html>
<html lang="en" x-data="{ sidebarOpen: false, collapsed: false }" :class="{ 'overflow-hidden': sidebarOpen }">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body class="bg-gray-100 text-gray-800">

  <!-- Page wrapper -->
  <div class="min-h-screen flex">

    <!-- Sidebar -->
    <aside
      :class="collapsed ? 'w-20' : 'w-64'"
      x-bind:class="sidebarOpen ? 'fixed inset-y-0 left-0 z-40' : ''"
      class="bg-white border-r border-gray-200 transition-all duration-200 ease-in-out"
    >
      <div class="h-full flex flex-col">
        <!-- Brand / toggle -->
        <div class="flex items-center justify-between p-4 border-b border-gray-100">
          <div class="flex items-center space-x-3">
            <img src="{% static 'images/logo.svg' %}" alt="logo" class="h-8 w-8">
            <span x-show="!collapsed" class="text-lg font-semibold">MyApp</span>
          </div>

          <div class="flex items-center space-x-2">
            <!-- collapse button -->
            <button @click="collapsed = !collapsed" class="p-2 rounded-md hover:bg-gray-100" :title="collapsed ? 'Expand' : 'Collapse'">
              <svg x-show="!collapsed" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"/>
              </svg>
              <svg x-show="collapsed" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>

            <!-- mobile menu toggle -->
            <button @click="sidebarOpen = !sidebarOpen" class="md:hidden p-2 rounded-md hover:bg-gray-100">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M3 5h14M3 10h14M3 15h14" clip-rule="evenodd" />
              </svg>
            </button>
          </div>
        </div>

        <!-- Nav -->
        <nav class="flex-1 overflow-auto py-4">
          <ul class="space-y-1 px-2">
            <li>
              <a href="{% url 'dashboard' %}" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors">
                <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 13h8V3H3v10zM3 21h8v-6H3v6zM13 21h8V11h-8v10zM13 3v6h8V3h-8z"/></svg>
                <span x-show="!collapsed" class="truncate">Overview</span>
              </a>
            </li>

            <li>
              <a href="{% url 'users' %}" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors">
                <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M17 21v-2a4 4 0 00-3-3.87M7 21v-2a4 4 0 013-3.87M12 7a4 4 0 110-8 4 4 0 010 8z"/></svg>
                <span x-show="!collapsed" class="truncate">Users</span>
              </a>
            </li>

            <li>
              <a href="{% url 'reports' %}" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors">
                <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 3h18v18H3z"/></svg>
                <span x-show="!collapsed" class="truncate">Reports</span>
              </a>
            </li>

            <li>
              <a href="{% url 'settings' %}" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors">
                <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 15.5A3.5 3.5 0 1 0 12 8.5a3.5 3.5 0 0 0 0 7z"/></svg>
                <span x-show="!collapsed" class="truncate">Settings</span>
              </a>
            </li>
          </ul>
        </nav>

        <!-- Sidebar footer -->
        <div class="p-4 border-t border-gray-100">
          <a href="{% url 'profile' %}" class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50">
            <img src="{% static 'images/avatar-placeholder.png' %}" alt="avatar" class="h-8 w-8 rounded-full">
            <div x-show="!collapsed" class="text-sm">
              <div class="font-medium">{{ request.user.email }}</div>
              <div class="text-xs text-gray-500">View profile</div>
            </div>
          </a>
        </div>
      </div>
    </aside>

    <!-- Overlay for mobile -->
    <div x-show="sidebarOpen" @click="sidebarOpen = false" class="fixed inset-0 bg-black/30 z-30 md:hidden"></div>

    <!-- Main content -->
    <main class="flex-1 p-6 md:p-8">
      <!-- Top navigation -->
      <header class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-4">
          <button @click="sidebarOpen = !sidebarOpen" class="md:hidden p-2 rounded-md hover:bg-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M4 6h16M4 12h16M4 18h16"/></svg>
          </button>

          <h2 class="text-2xl font-semibold">Dashboard</h2>
          <p class="text-sm text-gray-500">Welcome back â€” here's what's happening.</p>
        </div>

        <div class="flex items-center gap-4">
          <!-- Search -->
          <div class="relative hidden md:block">
            <input type="text" placeholder="Search..."
                   class="pl-10 pr-4 py-2 rounded-lg border border-gray-200 bg-white focus:outline-none focus:ring-2 focus:ring-green-500">
            <div class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
              <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M11 19a8 8 0 100-16 8 8 0 000 16z"/><path d="M21 21l-4.35-4.35"/></svg>
            </div>
          </div>

          <!-- Notifications -->
          <button class="p-2 rounded-md hover:bg-white">
            <svg class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5"/></svg>
          </button>

          <!-- Avatar dropdown (simple) -->
          <div x-data="{ open: false }" class="relative">
            <button @click="open = !open" class="flex items-center gap-2 rounded-full p-1 hover:bg-white">
              <img src="{% static 'images/avatar-placeholder.png' %}" alt="avatar" class="h-8 w-8 rounded-full">
            </button>

            <div x-show="open" @click.outside="open = false" x-transition class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border">
              <a href="{% url 'profile' %}" class="block px-4 py-2 text-sm hover:bg-gray-50">Profile</a>
              <a href="{% url 'settings' %}" class="block px-4 py-2 text-sm hover:bg-gray-50">Settings</a>
              <form method="POST" action="{% url 'login' %}">
                {% csrf_token %}
                <button type="submit" class="w-full text-left px-4 py-2 text-sm hover:bg-gray-50">Logout</button>
              </form>
            </div>
          </div>
        </div>
      </header>

      <!-- Dashboard grid -->
      <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">

        <!-- Cards -->
        <div class="col-span-1 lg:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-6">
          <div class="bg-white p-5 rounded-2xl shadow-sm border">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500">Total Users</p>
                <h3 class="text-2xl font-semibold">1,248</h3>
                <p class="text-xs text-gray-400 mt-1">+3.5% since last week</p>
              </div>
              <div class="bg-green-50 p-3 rounded-lg">
                <svg class="h-7 w-7 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M3 13h8V3H3v10zM3 21h8v-6H3v6zM13 21h8V11h-8v10zM13 3v6h8V3h-8z"/></svg>
              </div>
            </div>
          </div>

          <div class="bg-white p-5 rounded-2xl shadow-sm border">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500">New Signups</p>
                <h3 class="text-2xl font-semibold">76</h3>
                <p class="text-xs text-gray-400 mt-1">+8 from yesterday</p>
              </div>
              <div class="bg-green-50 p-3 rounded-lg">
                <svg class="h-7 w-7 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 2l3.5 7.5L23 10l-6 5 1.5 8L12 19l-6.5 4L7 15 1 10l7.5-0.5L12 2z"/></svg>
              </div>
            </div>
          </div>

          <div class="bg-white p-5 rounded-2xl shadow-sm border">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500">Active Agents</p>
                <h3 class="text-2xl font-semibold">312</h3>
                <p class="text-xs text-gray-400 mt-1">Stability: good</p>
              </div>
              <div class="bg-yellow-50 p-3 rounded-lg">
                <svg class="h-7 w-7 text-yellow-600" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 8v4l3 3"/></svg>
              </div>
            </div>
          </div>

          <div class="bg-white p-5 rounded-2xl shadow-sm border">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500">Revenue</p>
                <h3 class="text-2xl font-semibold">$18,920</h3>
                <p class="text-xs text-gray-400 mt-1">+12% month over month</p>
              </div>
              <div class="bg-red-50 p-3 rounded-lg">
                <svg class="h-7 w-7 text-red-600" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 8v4l3 3"/></svg>
              </div>
            </div>
          </div>
        </div>

        <!-- Right column summary -->
        <div class="bg-white p-5 rounded-2xl shadow-sm border">
          <h4 class="text-sm font-semibold text-gray-600 mb-3">Quick Summary</h4>
          <ul class="space-y-3">
            <li class="flex items-center justify-between">
              <div class="text-sm">Open tickets</div>
              <div class="text-sm font-semibold">24</div>
            </li>
            <li class="flex items-center justify-between">
              <div class="text-sm">Pending approvals</div>
              <div class="text-sm font-semibold">8</div>
            </li>
            <li class="flex items-center justify-between">
              <div class="text-sm">Server status</div>
              <div class="text-sm font-semibold text-green-600">Online</div>
            </li>
          </ul>
        </div>
      </section>

      <!-- Table section -->
      <section class="bg-white p-6 rounded-2xl shadow-sm border">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold">Recent Users</h3>
          <div class="flex items-center gap-3">
            <input type="text" placeholder="Filter by name or email" class="px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-green-500">
            <button class="px-3 py-2 bg-green-600 text-white rounded-lg">Export</button>
          </div>
        </div>

        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Joined</th>
                <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-100">
              {% for u in users %}
              <tr class="hover:bg-gray-50">
                <td class="px-4 py-4 whitespace-nowrap">
                  <div class="flex items-center gap-3">
                    <img src="{% static 'images/avatar-placeholder.png' %}" alt="" class="h-8 w-8 rounded-full">
                    <div>
                      <div class="text-sm font-medium">{{ u.get_full_name|default:u.email }}</div>
                      <div class="text-xs text-gray-400">{{ u.profile.title|default:"-" }}</div>
                    </div>
                  </div>
                </td>
                <td class="px-4 py-4 text-sm text-gray-600">{{ u.email }}</td>
                <td class="px-4 py-4 text-sm text-gray-600">{{ u.role }}</td>
                <td class="px-4 py-4 text-sm text-gray-600">{{ u.date_joined|date:"M d, Y" }}</td>
                <td class="px-4 py-4 text-right text-sm">
                  <a href="{% url 'user_detail' u.id %}" class="px-3 py-1 rounded-md border text-sm">View</a>
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="5" class="px-4 py-6 text-center text-sm text-gray-500">No users found.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- simple pagination placeholder -->
        <div class="mt-4 flex items-center justify-between">
          <div class="text-sm text-gray-600">Showing {{ users.start_index }} - {{ users.end_index }} of {{ users.paginator.count }}</div>
          <div class="flex items-center gap-2">
            {% if users.has_previous %}
              <a href="?page={{ users.previous_page_number }}" class="px-3 py-1 border rounded-md">Previous</a>
            {% endif %}
            {% if users.has_next %}
              <a href="?page={{ users.next_page_number }}" class="px-3 py-1 border rounded-md">Next</a>
            {% endif %}
          </div>
        </div>
      </section>

    </main>
  </div>

</body>
</html>
